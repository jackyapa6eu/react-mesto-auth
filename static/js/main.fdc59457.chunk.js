(this["webpackJsonpreact-mesto-auth"]=this["webpackJsonpreact-mesto-auth"]||[]).push([[0],{32:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(1),s=n.n(c),i=n(22),o=n.n(i),r=(n(32),n(26)),u=n(2),l=n(3),p=s.a.createContext(),d=n.p+"static/media/header__logo.a307e1c4.svg",_=n(9),j=n(5),b=n.n(j);var h=function(e){var t=e.isLoggedIn,n=e.setIsLoggedIn,c=e.userEmail,i=e.setUserEmail,o=s.a.useState(!1),r=Object(u.a)(o,2),p=r[0],j=r[1],h=Object(l.h)(),m=Object(l.g)(),f=b()("header__burger-menu",{"header__burger-menu_opened":p}),O=b()("header__user-container","header__user-container_mobile",{"header__user-container_opened":p});function g(){localStorage.removeItem("jwt"),n(!1),i(""),m.push("/sign-in")}return Object(a.jsxs)("header",{className:"header",children:[t&&Object(a.jsxs)("div",{className:O,children:[Object(a.jsx)("span",{className:"header__email",children:c}),Object(a.jsx)("button",{className:"header__button",onClick:g,children:"\u0412\u044b\u0445\u043e\u0434"})]}),Object(a.jsxs)("div",{className:"header__container",children:[Object(a.jsx)("img",{className:"logo",src:d,alt:"\u043b\u043e\u0433\u043e\u0442\u0438\u043f Mesto"}),"/sign-up"===h.pathname&&Object(a.jsx)(_.b,{className:"header__link",to:"/sign-in",children:"\u0412\u043e\u0439\u0442\u0438"}),"/sign-in"===h.pathname&&Object(a.jsx)(_.b,{className:"header__link",to:"/sign-up",children:"\u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"}),t&&Object(a.jsxs)("div",{className:"header__user-container",children:[Object(a.jsx)("span",{className:"header__email",children:c}),Object(a.jsx)("button",{className:"header__button",onClick:g,children:"\u0412\u044b\u0445\u043e\u0434"})]}),t&&Object(a.jsx)("div",{className:f,onClick:function(){j(!p)}})]})]})};var m=function(e){var t=s.a.useContext(p),n=e.card.owner._id===t._id,c=e.card.likes.some((function(e){return e._id===t._id})),i=b()("place__like-button",{"place__like-button_active":c});return Object(a.jsxs)("article",{className:"place",children:[n&&Object(a.jsx)("button",{className:"place__remove-btn",onClick:function(){e.onCardDelete(e.card)}}),Object(a.jsx)("img",{className:"place__image",src:e.card.link,alt:e.card.name,onClick:function(){e.onCardClick(e.card),e.onFullImage(!0)}}),Object(a.jsxs)("div",{className:"place__description",children:[Object(a.jsx)("h2",{className:"place__title",children:e.card.name}),Object(a.jsxs)("div",{className:"place__like",children:[Object(a.jsx)("svg",{className:i,onClick:function(){e.onLikeClick(e.card)},width:"21",height:"19",viewBox:"0 0 21 19",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Object(a.jsx)("path",{d:"M18.8005 1.95849L18.8023 1.96024C20.7437 3.88233 20.7462 7.03905 18.8005 8.98466L10.361 17.4238L1.94628 9.00951C1.94569 9.00892 1.94511 9.00832 1.94453 9.00772C1.0188 8.06185 0.5 6.81051 0.5 5.48217C0.5 4.14855 1.00122 2.89987 1.94265 1.95849L1.94266 1.95849L1.94441 1.95672C3.86629 0.0157068 7.02186 0.0131363 8.96748 1.97793L8.96922 1.97967L10.0074 3.01784L10.3646 3.37496L10.7181 3.01425L11.7545 1.95673C13.6994 0.0138381 16.8563 0.014425 18.8005 1.95849Z",stroke:"black"})}),Object(a.jsx)("span",{className:"place__like-counter",children:e.card.likes.length})]})]})]},e.card._id)};var f=function(e){var t=s.a.useContext(p),n=e.cards,c=e.onAddPlace,i=e.onCardClick,o=e.onCardDelete,r=e.onCardLike,u=e.onEditAvatar,l=e.onEditProfile,d=e.onFullImage;return Object(a.jsxs)("main",{className:"content",children:[Object(a.jsxs)("section",{className:"profile",children:[Object(a.jsxs)("div",{className:"profile__avatar",onClick:u,children:[Object(a.jsx)("div",{className:"profile__overlay"}),Object(a.jsx)("img",{className:"profile__avatar-image",src:t.avatar,alt:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0444\u0438\u043b\u044f"})]}),Object(a.jsxs)("div",{className:"profile__info",children:[Object(a.jsx)("h1",{className:"profile__display-name",children:t.name}),Object(a.jsx)("button",{type:"button",className:"profile__edit-button",onClick:l}),Object(a.jsx)("p",{className:"profile__profession",children:t.about})]}),Object(a.jsx)("button",{type:"button",className:"profile__add-button",onClick:c})]}),Object(a.jsx)("section",{className:"places",children:n.map((function(e){return Object(a.jsx)(m,{card:e,onCardClick:i,onCardDelete:o,onFullImage:d,onLikeClick:r},e._id)}))})]})};var O=function(){return Object(a.jsx)("footer",{className:"footer",children:Object(a.jsx)("p",{className:"footer__copyright",children:"\xa9 ".concat((new Date).getFullYear()," Mesto Russia")})})};var g=function(e){var t=e.isOpen,n=e.name,c=e.onClose,s=e.onSubmit,i=e.title,o=e.children,r=b()("popup","popup_type_".concat(n),{popup_opened:t});return Object(a.jsx)("div",{className:r,children:Object(a.jsxs)("form",{className:"popup__form popup__form_type_".concat(n),name:n,onSubmit:s,noValidate:!0,children:[Object(a.jsx)("button",{type:"button",className:"popup__close-button",onClick:c}),Object(a.jsx)("h3",{className:"popup__title",children:i}),o]})})};var x=function(e){var t=e.isOpen,n=e.onClose,c=e.onUpdateUser,i=s.a.useContext(p),o=s.a.useState(""),r=Object(u.a)(o,2),l=r[0],d=r[1],_=s.a.useState(""),j=Object(u.a)(_,2),b=j[0],h=j[1];return s.a.useEffect((function(){d(i.name),h(i.about)}),[i]),Object(a.jsxs)(g,{name:"editprofile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c({name:l,about:b})},children:[Object(a.jsx)("input",{type:"text",name:"name",className:"popup__input popup__input_type_display-name",onChange:function(e){d(e.target.value)},value:l||"",id:"profile-display-name-input",required:!0,minLength:"2",maxLength:"40"}),Object(a.jsx)("span",{className:"popup__error popup__error_visible",id:"profile-display-name-input-error"}),Object(a.jsx)("input",{type:"text",name:"about",className:"popup__input popup__input_type_profession",onChange:function(e){h(e.target.value)},value:b||"",id:"profile-profession-input",required:!0,minLength:"2",maxLength:"200"}),Object(a.jsx)("span",{className:"popup__error popup__error_visible",id:"profile-profession-input-error"}),Object(a.jsx)("button",{type:"submit",className:"popup__button",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})},v=n(14);var C=function(e){var t=e.isOpen,n=e.onClose,c=e.onUpdateAvatar,i=s.a.useRef();return Object(a.jsxs)(g,{name:"editavatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault();var t=Object(v.a)({},i.current.name,i.current.value);c(t)},children:[Object(a.jsx)("input",{type:"url",name:"avatar",ref:i,className:"popup__input popup__input_type_avatar",id:"profile-avatar-input",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0}),Object(a.jsx)("span",{className:"popup__error popup__error_visible",id:"profile-avatar-input-error"}),Object(a.jsx)("button",{type:"submit",className:"popup__button",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})};var N=function(e){var t=e.isOpen,n=e.onAddPlace,c=e.onClose,i=s.a.useState(""),o=Object(u.a)(i,2),r=o[0],l=o[1],p=s.a.useState(""),d=Object(u.a)(p,2),_=d[0],j=d[1];return Object(a.jsxs)(g,{name:"addplace",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:t,onClose:c,onSubmit:function(e){e.preventDefault(),n({name:r,link:_})},children:[Object(a.jsx)("input",{type:"text",name:"name",className:"popup__input popup__input_type_place-name",onChange:function(e){l(e.target.value)},value:r,id:"place-name-input",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,minLength:"2",maxLength:"30"}),Object(a.jsx)("span",{className:"popup__error popup__error_visible",id:"place-name-input-error"}),Object(a.jsx)("input",{type:"url",name:"link",className:"popup__input popup__input_type_place-link",onChange:function(e){j(e.target.value)},value:_,id:"place-link-input",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0}),Object(a.jsx)("span",{className:"popup__error popup__error_visible",id:"place-link-input-error"}),Object(a.jsx)("button",{type:"submit",className:"popup__button",children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})]})};var k=function(e){var t=e.card,n=e.isOpen,c=e.onClose,s=b()("popup","popup_type_figure",{popup_opened:n});return Object(a.jsx)("div",{className:s,children:Object(a.jsxs)("figure",{className:"popup__figure",children:[Object(a.jsx)("button",{type:"button",className:"popup__close-button",onClick:c}),Object(a.jsx)("img",{className:"popup__image",src:t.link,alt:t.name}),Object(a.jsx)("figcaption",{className:"popup__caption",children:t.name})]})})},y=n(15),S=n(16),L=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(y.a)(this,e),this._headers=a,this._baseUrl=n}return Object(S.a)(e,[{key:"getInitialCards",value:function(){return this._fetcher("/cards","GET")}},{key:"getUserData",value:function(){return this._fetcher("/users/me","GET")}},{key:"updateUserData",value:function(e){return this._fetcher("/users/me","PATCH",e)}},{key:"likeCard",value:function(e){return this._fetcher("/cards/likes/".concat(e),"PUT")}},{key:"unLikeCard",value:function(e){return this._fetcher("/cards/likes/".concat(e),"DELETE")}},{key:"uploadNewCard",value:function(e){return this._fetcher("/cards","POST",e)}},{key:"deleteCard",value:function(e){return this._fetcher("/cards/".concat(e),"DELETE")}},{key:"updateAvatar",value:function(e){return this._fetcher("/users/me/avatar","PATCH",e)}},{key:"_fetcher",value:function(e,t,n){var a={method:t,headers:this._headers};return n&&(a.body=JSON.stringify(n)),fetch("".concat(this._baseUrl).concat(e),a).then((function(e){return e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))}))}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-16",headers:{authorization:"67c1746d-dc65-4cb3-99d8-23254d14e06e","Content-Type":"application/json"}}),U=function(){return Object(a.jsxs)("p",{className:"user__question",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? ",Object(a.jsx)(_.b,{className:"user__link",to:"/sing-in",children:"\u0412\u043e\u0439\u0442\u0438"})]})};var E=function(e){var t=e.texts,n=e.handleSubmit,c=s.a.useState(""),i=Object(u.a)(c,2),o=i[0],r=i[1],p=s.a.useState(""),d=Object(u.a)(p,2),_=d[0],j=d[1],h=Object(l.h)(),m=b()("user__button",{"user__button_type_sign-up":"/sign-up"===h.pathname}),f=b()("user",{"user_type_sign-up":"/sign-up"===h.pathname});return Object(a.jsxs)("form",{className:f,onSubmit:function(e){e.preventDefault(),n({password:_,email:o})},children:[Object(a.jsx)("h3",{className:"user__title",children:t.title}),Object(a.jsx)("input",{type:"email",className:"user__input",placeholder:"Email",onChange:function(e){r(e.target.value)},value:o||"",required:!0}),Object(a.jsx)("input",{type:"password",className:"user__input",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",onChange:function(e){j(e.target.value)},value:_||"",required:!0}),Object(a.jsx)("button",{type:"submit",className:m,children:t.buttonText}),"/sign-up"===h.pathname&&Object(a.jsx)(U,{})]})},I=n(24),w=n(25),T=function(e){var t=e.component,n=e.isLoggedIn,c=e.path,s=Object(w.a)(e,["component","isLoggedIn","path"]);return Object(a.jsx)(l.b,{path:c,children:function(){return n?Object(a.jsx)(t,Object(I.a)({},s)):Object(a.jsx)(l.a,{to:"/sign-in"})}})},D=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(y.a)(this,e),this._headers=a,this._baseUrl=n}return Object(S.a)(e,[{key:"getUserData",value:function(e){var t={"Content-Type":"application/json",Authorization:"Bearer ".concat(e)};return this._fetcher("/users/me","GET",null,t)}},{key:"createUser",value:function(e){return this._fetcher("/signup","POST",e)}},{key:"signInUser",value:function(e){return this._fetcher("/signin","POST",e)}},{key:"_fetcher",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._headers,c={method:t,headers:a};return n&&(c.body=JSON.stringify(n)),fetch("".concat(this._baseUrl).concat(e),c).then((function(e){return e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))}))}}]),e}())({baseUrl:"https://auth.nomoreparties.co",headers:{"Content-Type":"application/json"}}),P={title:"\u0412\u0445\u043e\u0434",buttonText:"\u0412\u043e\u0439\u0442\u0438"},A={title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",buttonText:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"};var F=function(e){var t=e.text,n=e.img,c=e.isOpened,s=e.onClose,i=b()("popup","popup_type_info-tool-tip",{popup_opened:c});return Object(a.jsx)("div",{className:i,children:Object(a.jsxs)("div",{className:"popup__form popup__form_type_info-tool-tip",children:[Object(a.jsx)("button",{type:"button",className:"popup__close-button popup__close-button_type_info-tool-tip",onClick:function(){s()}}),Object(a.jsx)("img",{className:"popup__image popup__image_type_info-tool-tip",src:n,alt:t}),Object(a.jsx)("p",{className:"popup__title popup__title_type_info-tool-tip",children:t})]})})},q=n.p+"static/media/success-registration.1b6082f8.svg",B=n.p+"static/media/error-registration.7c6a020b.svg";var J=function(){var e=s.a.useState(!1),t=Object(u.a)(e,2),n=t[0],c=t[1],i=s.a.useState(!1),o=Object(u.a)(i,2),d=o[0],_=o[1],j=s.a.useState(!1),b=Object(u.a)(j,2),m=b[0],g=b[1],v=s.a.useState(!1),y=Object(u.a)(v,2),S=y[0],U=y[1],I=s.a.useState({}),w=Object(u.a)(I,2),J=w[0],M=w[1],G=s.a.useState({}),z=Object(u.a)(G,2),H=z[0],R=z[1],V=s.a.useState([]),Y=Object(u.a)(V,2),Z=Y[0],K=Y[1],Q=s.a.useState(!1),W=Object(u.a)(Q,2),X=W[0],$=W[1],ee=s.a.useState(""),te=Object(u.a)(ee,2),ne=te[0],ae=te[1],ce=s.a.useState(!1),se=Object(u.a)(ce,2),ie=se[0],oe=se[1],re=s.a.useState(!1),ue=Object(u.a)(re,2),le=ue[0],pe=ue[1],de=Object(l.h)(),_e=Object(l.g)();function je(e){var t=Z.map((function(t){return t._id===e._id?e:t}));K(t)}function be(){U(!1),_(!1),c(!1),g(!1)}function he(e){D.getUserData(e).then((function(e){e&&(ae(e.data.email),$(!0),_e.push("/"))})).catch((function(e){console.log(e)}))}return s.a.useEffect((function(){Promise.all([L.getUserData(),L.getInitialCards()]).then((function(e){R(e[0]),K(e[1])})).catch((function(e){console.log(e)})),function(){var e=localStorage.getItem("jwt");e&&he(e)}()}),[]),Object(a.jsx)("div",{className:"page",children:Object(a.jsxs)(p.Provider,{value:H,children:[Object(a.jsx)(h,{isLoggedIn:X,setIsLoggedIn:$,userEmail:ne,setUserEmail:ae}),Object(a.jsxs)(l.d,{children:[Object(a.jsx)(l.b,{path:"/sign-up",children:Object(a.jsx)(E,{texts:A,handleSubmit:function(e){D.createUser(e).then((function(e){e?oe(!0):pe(!0)})).catch((function(e){pe(!0),console.log(e)}))},isSuccess:ie})}),Object(a.jsx)(l.b,{path:"/sign-in",children:Object(a.jsx)(E,{texts:P,handleSubmit:function(e){D.signInUser(e).then((function(e){e?(localStorage.setItem("jwt",e.token),he(e.token)):console.log("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a")})).catch((function(e){console.log(e)}))}})}),Object(a.jsx)(T,{path:"/",isLoggedIn:X,component:f,onEditProfile:function(){c(!0)},onAddPlace:function(){_(!0)},onEditAvatar:function(){g(!0)},onFullImage:U,onCardClick:M,cards:Z,onCardLike:function(e){e.likes.some((function(e){return e._id===H._id}))?L.unLikeCard(e._id).then((function(e){je(e)})).catch((function(e){console.log(e)})):L.likeCard(e._id).then((function(e){je(e)})).catch((function(e){console.log(e)}))},onCardDelete:function(e){L.deleteCard(e._id).then((function(){var t=Z.filter((function(t){return t._id!==e._id}));K(t)})).catch((function(e){console.log(e)}))}})]}),"/"===de.pathname&&Object(a.jsx)(O,{}),Object(a.jsx)(N,{isOpen:d,onClose:be,onAddPlace:function(e){L.uploadNewCard(e).then((function(e){K([e].concat(Object(r.a)(Z))),be()})).catch((function(e){console.log("error:",e)}))}}),Object(a.jsx)(x,{isOpen:n,onClose:be,onUpdateUser:function(e){L.updateUserData(e).then((function(e){R(e),be()})).catch((function(e){console.log(e)}))}}),Object(a.jsx)(C,{isOpen:m,onClose:be,onUpdateAvatar:function(e){L.updateAvatar(e).then((function(e){R(e),be()})).catch((function(e){console.log("error:",e)}))}}),Object(a.jsx)(k,{card:J,isOpen:S,onClose:be}),Object(a.jsx)(F,{text:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!",img:q,isOpened:ie,onClose:function(){oe(!1),_e.push("/sign-in")}}),Object(a.jsx)(F,{text:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \n\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.",img:B,isOpened:le,onClose:function(){pe(!1)}})]})})},M=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,39)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),s(e),i(e)}))};o.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(_.a,{children:Object(a.jsx)(J,{})})}),document.getElementById("root")),M()}},[[38,1,2]]]);
//# sourceMappingURL=main.fdc59457.chunk.js.map